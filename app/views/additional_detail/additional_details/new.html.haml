:javascript
  var service_id = '#{@additional_detail.service.id}'; 
%div{"ng-controller" => "FormCreationController"}
  = render :partial => 'additional_detail/additional_details/additional_details_question_modal'
  = render :partial => 'organization_breadcrumb'
  = form_for [:additional_detail, @service, @additional_detail], :html => { :role=>"form", "data-toggle"=>"validator"} do |f|
    .modal.fade{:id=>"importExportModal", :role=>"dialog", :tabindex=>"-1", "aria-labelledby"=>"myModalLabel"}
      .modal-dialog.modal-lg{:role=>"document"}
        .modal-content
          .modal-header
            %button{"type"=>"button", "class"=>"close", "data-dismiss"=>"modal", "aria-label"=>"Close"}
              %span{"aria-hidden"=>"true"} &times;
            %h4.modal-title= t(:additional_details)[:admin][:import_export_modal_header]
          .modal-body
            .panel.panel-default
              .panel-heading
                %h3.panel-title= t(:additional_details)[:admin][:import_export_panel_header]
              .panel-body
                .form-group
                  = f.text_area :form_definition_json, "rows" => "15", class: "form-control", "ng-model" => "form_definition_json"
          .modal-footer
            %button.btn.btn-success{"data-dismiss"=>"modal"}= t(:additional_details)[:admin][:close_button]  
    .row
      .col-md-8 
        .panel.panel-default
          .panel-heading
            %h3.panel-title= t(:additional_details)[:admin][:form_creation_panel_header]
          .panel-body
            - if @additional_detail.errors.any?
              .alert.alert-danger#error_explanation
                %strong
                  = pluralize(@additional_detail.errors.count, "error")
                  = t(:additional_details)[:admin][:form_creation_error]
                %ul
                  - @additional_detail.errors.full_messages.each do |msg|
                    %li= msg
            .row
              .col-md-6
                .form-group
                  = f.label :name 
                  = f.text_field :name, class: "form-control", :placeholder=>"Form Name", :required=>"required" 
                  .help-block.with-errors
              .col-md-6
                .form-group
                  = f.label :description
                  = f.text_field :description, class: "form-control", :placeholder=>"Description (Optional)","ng-model" => "currentLineItemAD.additional_detail_description"
                  .help-block.with-errors
            .row
              .col-md-6
                .form-group
                  = f.label :effective_date
                  = f.text_field :effective_date, :type => 'text',class: "form-control datepicker", "ng-model" => "effective_date", "date-format"=>"yyyy-MM-dd", :placeholder=>"Effective Date", :required=>"required", "data-min-date"=> "{{datePickerMinDate}}", "data-date-type"=>"string", :cursor=>"pointer", "bs-datepicker"=>"bs-datepicker", :autoclose =>"true"
                  .help-block.with-errors
              .col-md-6
                .form-group
                  =f.label :enabled
                  =f.check_box :enabled, class: "checkbox"    
            .row
              .col-md-12
                .panel.panel-default
                  .panel-heading.clearfix 
                    %h3.panel-title.pull-left= t(:additional_details)[:admin][:form_creation_questions_header]
                    .btn-group.btn-group-sm.pull-right
                      %button.btn.btn-primary{:type=>"button","ng-click"=>"editQuestion()"}= t(:additional_details)[:admin][:add_question_button]
                      %button.btn.btn-warning{:type=>"button","ng-click"=>"deleteSelected()"}= t(:additional_details)[:admin][:delete_question_button] 
                      %button.btn.btn-danger{:type=> "button","ng-click"=>"deleteAllQuestion()"}= t(:additional_details)[:admin][:delete_all_questions_button]
                  .panel-body
                    %div{:id=>"gridId", "ui-grid"=>"gridModel", "ui-grid-edit"=>"true", "ui-grid-auto-resize"=>"true", "ui-grid-selection"=>"true", "external-scopes"=>"$scope", "ng-style"=> "getTableHeight()"}
                %input.btn.btn-success{:type=>"submit", :value=> t(:additional_details)[:admin][:save_form_button] }
                %button.btn.btn-info{"type"=>"button", "data-toggle"=>"modal", "data-target"=>"#importExportModal"}= t(:additional_details)[:admin][:import_export_button]
                %a.btn.btn-default{:type=>"button", :href=>"/additional_detail/services/#{@service.id}/additional_details/"}= t(:additional_details)[:admin][:cancel_button]
      .col-md-4 
        = render :partial => 'additional_detail/shared/additional_detail_form_panel'
        .panel.panel-default
          .panel-heading
            %h3.panel-title= t(:additional_details)[:admin][:form_data_preview_header]
          .panel-body
            %pre{"ng-cloak"=>"true"} {{pretty()}}          
:javascript
  // for import/export form schema, put the user's focus inside the textarea that contains the JSON form schema
  $('#importExportModal').on('shown.bs.modal', function () {
    $('#additional_detail_form_definition_json').focus();
  })